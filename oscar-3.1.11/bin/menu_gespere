#!/bin/bash

## Copyright (c) 2003-2013 Tissoires Jean-François & Benjamin,  jftissoires@gmail.com
## Outil Système Complet d'Assistance Réseau: OSCAR
## Rapide de Sauvegarde aux Ordinateurs et Systèmes: RapideSOS
## Ce programme est sous Licence Publique Générale GNU publiée par la Free Software Foundation.

#   programme de menu administrateur réseau pour l'autorun

#----------------------------------------------------------------------------------------------------
eteindre_le_poste()
{
runme boite_eteindre_le_poste
if ( test -e /tmp/annuler_eteindre )
then
	rm -f /tmp/annuler_eteindre
	main
	return
fi

runme boite_eteindre_ordinateur
}
#----------------------------------------------------------------------------------------------------
boucle()  # retour au programme principal
{
echo
echo
echo -e "\033[1;34mpour faire défiler l'écran utilisez \033[1;37m Maj_PgUp \033[1;34m ou \033[1;37m Maj_PgDn\033[1;m"
echo -ne "\033[1;34mappuyez sur la touche\033[1;37m Entrée \033[1;34mpour continuer...\033[1;m"
read reponse
main
}
#----------------------------------------------------------------------------------------------------
main()
{
rm -f /tmp/sortir
rm -f /tmp/tempfile # des menus precedents sauf celui-ci tempfile______
rm -f /tmp/tempfile___
rm -f /tmp/tempfile____
rm -f /tmp/tempfile_____

rm -f /tmp/tempfile_______

calendrier=$(date +%d/%m/%y)
heure=$(date +%kh%Mmin)
rm -f /tmp/rien
echo "\Zn  \Zn  \Zn  \Zn  \Zn  \Zn  \Zn  \Zn  \Zn  \Zn  \Zn  \Zn  " > /tmp/rien
output=exit
dialog  --no-cancel --colors --no-shadow \
	--backtitle "`cat /etc/banniere_oscar`" --title " Menu GESPERE " \
	--menu  "\n  \Zb\Z3  Faites votre choix : `cat /tmp/rien`  le $calendrier à $heure\n " 11 111 0  \
	" " "" \
	"liste_mots_de_passe" "Prépare les \Z1mots de passe\Z2 GESPERE\Zn pour impression." \
	" " "" \
	"partitions" "Montre les \Z1partitions\Zn des périphériques." \
        "halt" "\Z1Eteindre\Zn l'ordinateur." \
	"oscar" "Revenir au \Z1menu principal\Zn. " \
	" " "" 2>/tmp/tempfile______
	
if [ $? = "255" ]
then
    rm -f /tmp/tempfile______
    rm -f /tmp/rien
    exit
fi
output=`cat /tmp/tempfile______`
rm -f /tmp/rien

if [ "$output" = " " ]
	then
	main
elif [ "$output" = "" ]
	then
	main
elif [ $output = "liste_mots_de_passe" ]
then
	gespere_mdp
	main
elif [ $output = "partitions" ]
	then
	runme information_dd
	rm -f /tmp/fichier_disque_dur
	main
elif [ "$output" = "halt" ]
then
	rm -f /tmp/tempfile______
        eteindre_le_poste
elif [ $output = "oscar" ]
then
	rm -f /tmp/tempfile______
	exit
else
$output
fi
rm -f /tmp/tempfile______
boucle
}
#----------------------------------------------------------------------------------------------------
PATH="/usr/share/oscar/bin:$PATH"
main